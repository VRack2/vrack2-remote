# VRackRemote - –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å VRack2 API

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å VRack2 —Å–µ—Ä–≤–µ—Ä–æ–º —á–µ—Ä–µ–∑ –∑–∞—â–∏—â–µ–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è, –∫–æ–º–∞–Ω–¥ –∏ —à–∏—Ä–æ–∫–æ–≤–µ—â–∞—Ç–µ–ª—å–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤.

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
npm install vrack2-remote
```

## –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üîí –ó–∞—â–∏—â–µ–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å AES-CBC —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º
- üì° –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–º–∞–Ω–¥ –∏ –æ—Ç–≤–µ—Ç–æ–≤ —Å —Ç–∞–π–º–∞—É—Ç–∞–º–∏
- üì¢ –®–∏—Ä–æ–∫–æ–≤–µ—â–∞—Ç–µ–ª—å–Ω—ã–µ –∫–∞–Ω–∞–ª—ã (pub/sub)
- üîë –î–≤—É—Ö—ç—Ç–∞–ø–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (API key + –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á)
- ‚è± –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–µ—Ä–µ–¥—å –∫–æ–º–∞–Ω–¥ —Å —Ç–∞–π–º–∞—É—Ç–∞–º–∏
- üö¶ –ö–æ–Ω—Ç—Ä–æ–ª—å —É—Ä–æ–≤–Ω—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–æ–º–∞–Ω–¥–∞–º

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

```javascript
import VRackRemoteWeb from 'vrack2-remote'

// –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä (—É–∫–∞–∂–∏—Ç–µ –≤–∞—à API –∫–ª—é—á –∏ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á)
const remote = new VRackRemoteWeb('ws://localhost:4044','–≤–∞—à_api_–∫–ª—é—á', '–≤–∞—à_–ø—Ä–∏–≤–∞—Ç–Ω—ã–π_–∫–ª—é—á')

// –ò–ª–∏ –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –∫–ª—é—á–∏ –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è
remote.setKey(this.connection.secret)
remote.setPrivateKey(this.connection.private)
// –ò–ª–∏ –ø–æ–º–µ–Ω—è—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ö–æ—Å—Ç –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è
remote.host = 'ws://localhost:4044'

// –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
remote.on('open', () => console.log('–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ'))
remote.on('close', () => console.log('–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–æ'))
remote.on('error', (err) => console.error('–û—à–∏–±–∫–∞:', err))
try {
    // –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å —Å–µ—Ä–≤–µ—Ä–æ–º - –û–∂–∏–¥–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞
    await this.remote.connect()
    //  –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è - –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ —Å–µ—Ä–≤–µ—Ä—É
    await this.remote.apiKeyAuth()
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∫–æ–º–º–∞–Ω–¥ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–æ–º–∞–Ω–¥–∞–º
    await this.remote.commandsListUpdate()
}catch (error){
    console.error(error)
}
```

### –†–∞–±–æ—Ç–∞ —Å –∫–æ–º–∞–Ω–¥–∞–º–∏

```javascript
// –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã
try {
  const services = await this.remote.command('serviceUpdateList', {})
  console.log('–†–µ–∑—É–ª—å—Ç–∞—Ç:', services)
} catch (e) {
  console.error('–û—à–∏–±–∫–∞ –∫–æ–º–∞–Ω–¥—ã:', e)
}

// –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Ä–æ–≤–Ω—è –¥–æ—Å—Ç—É–ø–∞
if (remote.checkAccess('serviceUpdateList')) {
  // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã
}
```

### –†–∞–±–æ—Ç–∞ —Å –∫–∞–Ω–∞–ª–∞–º–∏

–ù–∞ –æ–¥–∏–Ω –∫–∞–Ω–∞–ª –º–æ–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–Ω—É callback —Ñ—É–Ω–∫—Ü–∏—é. –í—ã –º–æ–∂–µ—Ç–µ –ø–æ–≤–µ—Å–∏—Ç—å —Å–≤–æ–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ callback —Ñ—É–Ω–∫—Ü–∏–π.

```javascript
// –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∫–∞–Ω–∞–ª
await remote.channelJoin('services.service.devices.DeviceID.render', (data) => {
  console.log('–ù–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ:', data)
})

// –û—Ç–ø–∏—Å–∫–∞ –æ—Ç –∫–∞–Ω–∞–ª–∞
await remote.channelLeave('services.service.devices.DeviceID.render')
```

## API

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã

- `setKey(key)` - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å API –∫–ª—é—á
- `setPrivateKey(privateKey)` - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á
- `command(command, params)` - –í—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É
  - `command` - –ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã
  - `params` - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–º–∞–Ω–¥—ã (–æ–±—ä–µ–∫—Ç)
- `channelJoin(channel, callback)` - –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∫–∞–Ω–∞–ª
- `channelLeave(channel)` - –û—Ç–ø–∏—Å–∞—Ç—å—Å—è –æ—Ç –∫–∞–Ω–∞–ª–∞
- `apiKeyAuth()` - –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ API –∫–ª—é—á—É
- `commandsListUpdate()` - –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–º–∞–Ω–¥
- `checkAccess(command)` - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∫–æ–º–∞–Ω–¥–µ

### –°–æ–±—ã—Ç–∏—è

- `open` - –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ
- `close` - –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–æ
- `error` - –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞

### –§–ª–∞–≥–∏/–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

–ú–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: 
```ts
if (remote.connected) {} // ... 
```

 - `connected` - –§–ª–∞–≥ —É—Å–ø–µ—à–Ω–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
 - `connection` - –§–ª–∞–≥ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ
 - `cipher` - –§–ª–∞–≥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
 - `level` - –¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å –¥–æ—Å—Ç—É–ø–∞ (1000,3,2,1)
 - `commandsList` - –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–º–º–∞–Ω–¥